---
language: java

include_files:
- CONTRIBUTING.md
- LICENSE
- NOTICE
- README.md
- VERSION
- bin/compile
- bin/detect
- bin/finalize
- bin/release
- bin/supply
- manifest.yml
pre_package: scripts/build.sh

default_versions:
- name: openjdk
  version: 17.x
- name: zulu
  version: 11.x
- name: sapmachine
  version: 17.x
- name: tomcat
  version: 10.1.x
- name: groovy
  version: 4.0.x
- name: jvmkill
  version: 1.x
- name: memory-calculator
  version: 4.x
- name: auto-reconfiguration
  version: 2.x
- name: java-cfenv
  version: 3.x
- name: postgresql-jdbc
  version: 42.x
- name: mariadb-jdbc
  version: 3.x
- name: datadog-javaagent
  version: 1.x
- name: elastic-apm-agent
  version: 1.x

url_to_dependency_map:
- match: openjdk-jre-(\d+\.\d+\.\d+)
  name: openjdk
  version: $1
- match: zulu(\d+\.\d+\.\d+)-.*-jre(\d+\.\d+\.\d+)
  name: zulu
  version: $2
- match: sapmachine-jre-(\d+\.\d+\.\d+)
  name: sapmachine
  version: $1
- match: tomcat-(\d+\.\d+\.\d+)
  name: tomcat
  version: $1
- match: jvmkill-(\d+\.\d+\.\d+)
  name: jvmkill
  version: $1
- match: memory-calculator-(\d+\.\d+\.\d+)
  name: memory-calculator
  version: $1
- match: new-relic-(\d+\.\d+\.\d+)
  name: new-relic
  version: $1
- match: app-dynamics-(\d+\.\d+\.\d+\.\d+)
  name: app-dynamics
  version: $1
- match: dynatrace-(\d+\.\d+\.\d+)
  name: dynatrace
  version: $1
- match: auto-reconfiguration-(\d+\.\d+\.\d+)
  name: auto-reconfiguration
  version: $1
- match: java-cfenv-(\d+\.\d+\.\d+)
  name: java-cfenv
  version: $1
- match: postgresql-(\d+\.\d+\.\d+)
  name: postgresql-jdbc
  version: $1
- match: mariadb-java-client-(\d+\.\d+\.\d+)
  name: mariadb-jdbc
  version: $1
- match: dd-java-agent-(\d+\.\d+\.\d+)
  name: datadog-javaagent
  version: $1
- match: elastic-apm-agent-(\d+\.\d+\.\d+)
  name: elastic-apm-agent
  version: $1

dependency_deprecation_dates:
- version_line: 8.x
  name: openjdk
  date: 2026-11-30
  link: https://adoptium.net/support/
  match: 8\.\d+\.\d+
- version_line: 11.x
  name: openjdk
  date: 2027-10-31
  link: https://adoptium.net/support/
  match: 11\.\d+\.\d+
- version_line: 17.x
  name: openjdk
  date: 2029-09-30
  link: https://adoptium.net/support/
  match: 17\.\d+\.\d+
- version_line: 21.x
  name: openjdk
  date: 2031-09-30
  link: https://adoptium.net/support/
  match: 21\.\d+\.\d+
- version_line: 23.x
  name: openjdk
  date: 2025-09-30
  link: https://adoptium.net/support/
  match: 23\.\d+\.\d+

dependencies:
# OpenJDK JRE versions
# Version 8
- name: openjdk
  version: 8.0.422
  uri: https://github.com/adoptium/temurin8-binaries/releases/download/jdk8u422-b05/OpenJDK8U-jre_x64_linux_hotspot_8u422b05.tar.gz
  sha256: 0ac516cc1eadffb4cd3cfc9736a33d58ea6a396bf85729036c973482f7c063d9
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Version 11
- name: openjdk
  version: 11.0.25
  uri: https://github.com/adoptium/temurin11-binaries/releases/download/jdk-11.0.25%2B9/OpenJDK11U-jre_x64_linux_hotspot_11.0.25_9.tar.gz
  sha256: 84cd7101f39172a4db085fb52940595bb14dad6bc3afb5bf82ee497eceaf86d3
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Version 17
- name: openjdk
  version: 17.0.13
  uri: https://github.com/adoptium/temurin17-binaries/releases/download/jdk-17.0.13%2B11/OpenJDK17U-jre_x64_linux_hotspot_17.0.13_11.tar.gz
  sha256: 4086cc7cb2d9e7810141f255063caad10a8a018db5e6b47fa5394c506ab65bff
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Version 21
- name: openjdk
  version: 21.0.5
  uri: https://github.com/adoptium/temurin21-binaries/releases/download/jdk-21.0.5%2B11/OpenJDK21U-jre_x64_linux_hotspot_21.0.5_11.tar.gz
  sha256: 553dda64b3b1c3c16f8afe402377ffebe64fb4a1721a46ed426a91fd18185e62
  cf_stacks:
  - cflinuxfs4

# Version 23
- name: openjdk
  version: 23.0.1
  uri: https://github.com/adoptium/temurin23-binaries/releases/download/jdk-23.0.1%2B11/OpenJDK23U-jre_x64_linux_hotspot_23.0.1_11.tar.gz
  sha256: 1233cbec40f05c76ad926b68521ae78c6ae4f454996ef549602be6987069fa77
  cf_stacks:
  - cflinuxfs4

# Zulu JRE versions (Azul Zulu OpenJDK)
# Note: These are placeholder entries. Actual downloads require proper repository setup.
# Repository: https://cdn.azul.com/zulu/bin
# Version 8
- name: zulu
  version: 8.0.422
  uri: https://cdn.azul.com/zulu/bin/zulu8.80.0.17-ca-jre8.0.422-linux_x64.tar.gz
  sha256: 7ff2e01766fe9b1f55cd441a0b14f3889f479b5d963bfbf5df9d1b7d82ac5c87
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Version 11
- name: zulu
  version: 11.0.25
  uri: https://cdn.azul.com/zulu/bin/zulu11.76.21-ca-jre11.0.25-linux_x64.tar.gz
  sha256: 2696d23e20a7e6cc22d36a27c3d917b6b390d0e6ac1819e791d99a1fc159317c
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Version 17
- name: zulu
  version: 17.0.13
  uri: https://cdn.azul.com/zulu/bin/zulu17.54.21-ca-jre17.0.13-linux_x64.tar.gz
  sha256: 2d74f026d0d184075ad99de343c6a24bd702eb25d87ce6de5e3ab8df1cd3ef25
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# SAP Machine JRE versions
# Repository: https://github.com/SAP/SapMachine/releases
# Version 11
- name: sapmachine
  version: 11.0.25
  uri: https://github.com/SAP/SapMachine/releases/download/sapmachine-11.0.25/sapmachine-jre-11.0.25_linux-x64_bin.tar.gz
  sha256: 10f3eb5b93c2c26f7c69a3690d5877b401b5ab24a6b1798fac5518beb1f1f839
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Version 17
- name: sapmachine
  version: 17.0.13
  uri: https://github.com/SAP/SapMachine/releases/download/sapmachine-17.0.13/sapmachine-jre-17.0.13_linux-x64_bin.tar.gz
  sha256: b5f16befcb6415cfcf3bdb57b361c8eeca8176d494cd1e6c067cd56acec1afe6
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# GraalVM JRE versions
# Note: GraalVM requires user-provided repository configuration via JBP_CONFIG_GRAAL_VM_JRE
# Users must specify repository_root in buildpack.yml or environment variables
# Example: JBP_CONFIG_GRAAL_VM_JRE='{jre: {repository_root: "https://example.com/graalvm"}}'

# Tomcat versions
- name: tomcat
  version: 9.0.98
  uri: https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.98/bin/apache-tomcat-9.0.98.tar.gz
  sha256: 1d9a1104c2e235a5baff6e9ca8e28be3d864803fafc478f5c13c2ae6a5ed3d6f
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

- name: tomcat
  version: 10.1.33
  uri: https://archive.apache.org/dist/tomcat/tomcat-10/v10.1.33/bin/apache-tomcat-10.1.33.tar.gz
  sha256: 3b2b21d61cd587b5f838da1843763feaa5e864fe05975a101dade0922de50895
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Groovy versions
- name: groovy
  version: 4.0.23
  uri: https://groovy.jfrog.io/artifactory/dist-release-local/groovy-zips/apache-groovy-binary-4.0.23.zip
  sha256: 7089dd7a1e84adc814d616f5ec2f7d7dac2044a0a0457f3341b3b92d30204229
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# JVM Kill Agent
- name: jvmkill
  version: 1.16.0
  uri: https://github.com/cloudfoundry/jvmkill/releases/download/v1.16.0.RELEASE/jvmkill-1.16.0-RELEASE.so
  sha256: a3092627b082cb3cdbbe4b255d35687126aa604e6b613dcda33be9f7e1277162
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Memory Calculator
- name: memory-calculator
  version: 4.0.0
  uri: https://java-buildpack.cloudfoundry.org/memory-calculator/bionic/x86_64/memory-calculator-4.0.0.tgz
  sha256: 90d40eab6959a7b4059c6409c4505040e8a04f75a481f7282e53430df3edda3e
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

- name: memory-calculator
  version: 4.1.0
  uri: https://github.com/cloudfoundry/java-buildpack-memory-calculator/releases/download/v4.1.0/memory-calculator-4.1.0.tgz
  sha256: 0ba6fa26b32e4b906ab460a7cdb70ebded95ea353fdda93bd7f5792300b9cd43
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# NOTE: Tomcat support JARs are currently unavailable from the CF buildpack repository
# These will be added when new versions are published or alternative sources are found
# Commenting out for now to allow packaging to succeed:
#
# - name: tomcat-lifecycle-support
#   version: 3.3.0
#   uri: https://java-buildpack.cloudfoundry.org/tomcat-lifecycle-support/tomcat-lifecycle-support-3.3.0.jar
#   sha256: 00daef2fa841ae910c9adbc777c26a51a146319467836f5b6d9f9064e99b1fa7
#
# - name: tomcat-logging-support
#   version: 3.3.0
#   uri: https://java-buildpack.cloudfoundry.org/tomcat-logging-support/tomcat-logging-support-3.3.0.jar
#   sha256: 2393e85045a07b4e9543cd09cb5e1918494216733b450fafd10647540653771e
#
# - name: tomcat-access-logging-support
#   version: 3.3.0
#   uri: https://java-buildpack.cloudfoundry.org/tomcat-access-logging-support/tomcat-access-logging-support-3.3.0.jar
#   sha256: 17f1bcbd9b193862605d06e9d126961e8a9d7d21dd58dfc54e5ca13e31316af5

# APM Agents
# New Relic
- name: new-relic
  version: 8.15.0
  uri: https://download.newrelic.com/newrelic/java-agent/newrelic-agent/8.15.0/newrelic-java-8.15.0.zip
  sha256: 7be360e4ce20eadad06cc30d2917c258a97b9710725a35774537e88fada8f113
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# NOTE: AppDynamics and Dynatrace require authentication or environment-specific URLs
# These should be configured at runtime via buildpack.yml or service bindings
# Uncomment and update URLs when available:
#
# - name: app-dynamics
#   version: 24.11.0.36457
#   uri: https://download-files.appdynamics.com/download-file/java/24.11.0.36457/AppServerAgent-24.11.0.36457.zip
#   sha256: TBD
#   cf_stacks:
#   - cflinuxfs4
#
# - name: dynatrace
#   version: 1.303.0
#   uri: https://your-dynatrace-environment.com/api/v1/deployment/installer/agent/unix/paas/latest
#   sha256: TBD
#   cf_stacks:
#   - cflinuxfs4

# Datadog Javaagent
- name: datadog-javaagent
  version: 1.42.1
  uri: https://repo1.maven.org/maven2/com/datadoghq/dd-java-agent/1.42.1/dd-java-agent-1.42.1.jar
  sha256: e703547f69695d2b3dbfcfa7e920bfa6e86decebe015e7047c313736d2268928
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Elastic APM Agent
- name: elastic-apm-agent
  version: 1.52.0
  uri: https://repo1.maven.org/maven2/co/elastic/apm/elastic-apm-agent/1.52.0/elastic-apm-agent-1.52.0.jar
  sha256: ef6c8f75bd6181e717cdd172864441580708c7ee8543175621a3f404f4ba6429
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Spring Auto-reconfiguration
- name: auto-reconfiguration
  version: 2.12.0
  uri: https://java-buildpack.cloudfoundry.org/auto-reconfiguration/auto-reconfiguration-2.12.0-RELEASE.jar
  sha256: 78dc1c2b3d3b6fb4ab94f38004ad1fbeb81992d942bd564127ca5d3da3cd2010
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# Java CF Env
- name: java-cfenv
  version: 3.5.0
  uri: https://java-buildpack.cloudfoundry.org/java-cfenv/java-cfenv-3.5.0.jar
  sha256: 6a761fe530783c0ec9e6d1713ef54f6504803bf1ad02856d3ee7b46211f905c5
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# PostgreSQL JDBC Driver
- name: postgresql-jdbc
  version: 42.7.4
  uri: https://repo1.maven.org/maven2/org/postgresql/postgresql/42.7.4/postgresql-42.7.4.jar
  sha256: 188976721ead8e8627eb6d8389d500dccc0c9bebd885268a3047180274a6031e
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# MariaDB JDBC Driver
- name: mariadb-jdbc
  version: 3.5.1
  uri: https://repo1.maven.org/maven2/org/mariadb/jdbc/mariadb-java-client/3.5.1/mariadb-java-client-3.5.1.jar
  sha256: 50a50c4a3c13c30dfbd40587f7ad9a496197d285ede0948641d9eee68fdf2106
  cf_stacks:
  - cflinuxfs4
  - cflinuxfs3

# NOTE: This manifest.yml includes core dependencies for:
# ✅ OpenJDK JRE versions: 8, 11, 17, 21, 23
# ✅ Tomcat versions: 9.x, 10.x
# ✅ Groovy 4.x
# ✅ JVMKill agent and Memory Calculator
# ✅ Tomcat support libraries (commented out - unavailable)
# ✅ APM agents: New Relic, Datadog, Elastic APM (AppDynamics, Dynatrace require auth)
# ✅ Spring service bindings: Auto-reconfiguration, Java CF Env
# ✅ JDBC drivers: PostgreSQL, MariaDB
# ⚠️  Debug and JMX frameworks (no external dependencies - use app-provided tools)
#
# Additional dependencies still need to be added for:
# - Other JRE vendors (Zulu, GraalVM, SAP Machine, IBM JRE, Oracle JRE, Zing)
# - Other APM/monitoring agents (Azure App Insights, SkyWalking, Sealights, Introscope, etc.)
# - Security providers (Luna, ProtectApp, etc.)
# - Debug frameworks (JRebel, JProfiler, YourKit)
# - Spring Boot CLI, Play Framework, Ratpack support libraries
# 
# TODO: Calculate SHA256 checksums for all placeholder dependencies.
# Command: curl -sL <uri> | sha256sum
